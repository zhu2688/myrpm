<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>File: KNOWN_ISSUES [unicorn-4.8.3 Documentation]</title>

  <link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet" />

  <script src="./js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file">
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./Application_Timeouts.html">Application_Timeouts</a></li>
        
          <li class="file"><a href="./CONTRIBUTORS.html">CONTRIBUTORS</a></li>
        
          <li class="file"><a href="./ChangeLog.html">ChangeLog</a></li>
        
          <li class="file"><a href="./DESIGN.html">DESIGN</a></li>
        
          <li class="file"><a href="./FAQ.html">FAQ</a></li>
        
          <li class="file"><a href="./HACKING.html">HACKING</a></li>
        
          <li class="file"><a href="./ISSUES.html">ISSUES</a></li>
        
          <li class="file"><a href="./KNOWN_ISSUES.html">KNOWN_ISSUES</a></li>
        
          <li class="file"><a href="./LATEST.html">LATEST</a></li>
        
          <li class="file"><a href="./LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="./Links.html">Links</a></li>
        
          <li class="file"><a href="./NEWS.html">NEWS</a></li>
        
          <li class="file"><a href="./PHILOSOPHY.html">PHILOSOPHY</a></li>
        
          <li class="file"><a href="./README.html">README</a></li>
        
          <li class="file"><a href="./SIGNALS.html">SIGNALS</a></li>
        
          <li class="file"><a href="./Sandbox.html">Sandbox</a></li>
        
          <li class="file"><a href="./TODO.html">TODO</a></li>
        
          <li class="file"><a href="./TUNING.html">TUNING</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./Unicorn.html">Unicorn</a></li>
        
          <li><a href="./Unicorn/App.html">Unicorn::App</a></li>
        
          <li><a href="./Unicorn/App/OldRails.html">Unicorn::App::OldRails</a></li>
        
          <li><a href="./Unicorn/App/OldRails/Static.html">Unicorn::App::OldRails::Static</a></li>
        
          <li><a href="./Unicorn/CGIWrapper.html">Unicorn::CGIWrapper</a></li>
        
          <li><a href="./Unicorn/ClientShutdown.html">Unicorn::ClientShutdown</a></li>
        
          <li><a href="./Unicorn/Configurator.html">Unicorn::Configurator</a></li>
        
          <li><a href="./Unicorn/HttpParser.html">Unicorn::HttpParser</a></li>
        
          <li><a href="./Unicorn/HttpServer.html">Unicorn::HttpServer</a></li>
        
          <li><a href="./Unicorn/OobGC.html">Unicorn::OobGC</a></li>
        
          <li><a href="./Unicorn/PrereadInput.html">Unicorn::PrereadInput</a></li>
        
          <li><a href="./Unicorn/SSLClient.html">Unicorn::SSLClient</a></li>
        
          <li><a href="./Unicorn/SSLConfigurator.html">Unicorn::SSLConfigurator</a></li>
        
          <li><a href="./Unicorn/StreamInput.html">Unicorn::StreamInput</a></li>
        
          <li><a href="./Unicorn/TeeInput.html">Unicorn::TeeInput</a></li>
        
          <li><a href="./Unicorn/TmpIO.html">Unicorn::TmpIO</a></li>
        
          <li><a href="./Unicorn/Util.html">Unicorn::Util</a></li>
        
          <li><a href="./Unicorn/Worker.html">Unicorn::Worker</a></li>
        
          <li><a href="./ExecCgi/ExecCgi.html">ExecCgi::ExecCgi</a></li>
        
          <li><a href="./Inetd/Inetd.html">Inetd::Inetd</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    
<h1>Known Issues</h1>

<p>Occasionally odd <a href="ISSUES.html">issues</a> arise without a
transparent or acceptable solution.  Those issues are documented here.</p>
<ul><li>
<p>Some libraries/applications may install signal handlers which conflict with
signal handlers unicorn uses.  Leaving “preload_app false” (the default)
will allow unicorn to always override existing signal handlers.</p>
</li><li>
<p>Issues with FreeBSD jails can be worked around as documented by Tatsuya
Ono: <a
href="http://mid.gmane.org/CAHBuKRj09FdxAgzsefJWotexw-7JYZGJMtgUp_dhjPz9VbKD6Q@mail.gmail.com">mid.gmane.org/CAHBuKRj09FdxAgzsefJWotexw-7JYZGJMtgUp_dhjPz9VbKD6Q@mail.gmail.com</a></p>
</li><li>
<p>PRNGs (pseudo-random number generators) loaded before forking (e.g.
“preload_app true”) may need to have their internal state reset in the
after_fork hook.  Starting with Unicorn 3.6.1, we have builtin workarounds
for Kernel#rand and OpenSSL::Random users, but applications may use other
PRNGs.</p>
</li><li>
<p>Under some versions of Ruby 1.8, it is necessary to call <tt>srand</tt> in
an after_fork hook to get correct random number generation.  We have a
builtin workaround for this starting with Unicorn 3.6.1</p>

<p>See <a
href="http://redmine.ruby-lang.org/issues/show/4338">redmine.ruby-lang.org/issues/show/4338</a></p>
</li><li>
<p>On Ruby 1.8 prior to Ruby 1.8.7-p248, *BSD platforms have a broken stdio
that causes failure for file uploads larger than 112K.  Upgrade your
version of Ruby or continue using <a href="Unicorn.html">Unicorn</a>
1.x/3.4.x.</p>
</li><li>
<p>For notes on sandboxing tools such as Bundler or Isolate, see the <a
href="Sandbox.html">Sandbox</a> page.</p>
</li><li>
<p>nginx with “sendfile on” under FreeBSD 8 is broken when uploads are
buffered to disk.  Disabling sendfile is required to work around this bug
which should be fixed in newer versions of FreeBSD.</p>
</li><li>
<p>When using “preload_app true”, with apps using background threads need to
restart them in the after_fork hook because threads are never shared with
child processes.  Additionally, any synchronization primitives (Mutexes,
Monitors, ConditionVariables) should be reinitialized in case they are held
during fork time to avoid deadlocks.  The core Ruby Logger class needlessly
uses a MonitorMutex which can be disabled with a <a
href="examples/logger_mp_safe.rb">monkey patch</a></p>
</li></ul>

<h2>Known Issues (Old)</h2>
<ul><li>
<p>Under Ruby 1.9.1, methods like Array#shuffle and Array#sample will segfault
if called after forking.  Upgrade to Ruby 1.9.2 or call “Kernel.rand” in
your after_fork hook to reinitialize the random number generator.</p>

<p>See <a
href="http://redmine.ruby-lang.org/issues/show/2962">redmine.ruby-lang.org/issues/show/2962</a>
for more details</p>
</li><li>
<p>Rails 2.3.2 bundles its own version of Rack.  This may cause subtle bugs
when simultaneously loaded with the system-wide Rack Rubygem which <a
href="Unicorn.html">Unicorn</a> depends on.  Upgrading to Rails 2.3.4 (or
later) is strongly recommended for all Rails 2.3.x users for this (and
security reasons).  Rails 2.2.x series (or before) did not bundle Rack and
are should be unnaffected.  If there is any reason which forces your
application to use Rails 2.3.2 and you have no other choice, then you may
edit your <a href="Unicorn.html">Unicorn</a> gemspec and remove the Rack
dependency.</p>

<p>ref: <a
href="http://mid.gmane.org/20091014221552.GA30624@dcvr.yhbt.net">mid.gmane.org/20091014221552.GA30624@dcvr.yhbt.net</a>
Note: the workaround described in the article above only made the issue
more subtle and we didn’t notice them immediately.</p>
</li><li>
<p>WONTFIX: code reloading and restarts with Sinatra 0.3.x (and likely older
versions) apps is broken.  The workaround is to force production mode to
disable code reloading as well as disabling “run” in your Sinatra
application:</p>

<pre>set :env, :production
set :run, false</pre>

<p>Since this is no longer an issue with Sinatra 0.9.x apps, this will not be
fixed on our end.  Since <a href="Unicorn.html">Unicorn</a> is itself the
application launcher, the at_exit handler used in old Sinatra always caused
Mongrel to be launched whenever a <a href="Unicorn.html">Unicorn</a> worker
was about to exit.</p>

<p>Also remember we’re capable of replacing the running binary without
dropping any connections regardless of framework :)</p>
</li></ul>

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>
</body>
</html>

